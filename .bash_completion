#!/bin/bash

_AI()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}

    COMPREPLY=( $( apt-cache --no-generate pkgnames "$cur" 2> /dev/null ) )
    return 0
}
complete -F _AI ai

_AIV()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}

    COMPREPLY=( $( apt-cache --no-generate pkgnames "$cur" 2> /dev/null ) )
    return 0
}
complete -F _AIV aiv

_AQ()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}

    COMPREPLY=( $( apt-cache --no-generate pkgnames "$cur" 2> /dev/null ) )
    return 0
}
complete -F _AQ aq

_AG()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}

    COMPREPLY=( $( apt-cache --no-generate pkgnames "$cur" 2> /dev/null ) )
    return 0
}
complete -F _AG ag

_AQG()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}

    COMPREPLY=( $( apt-cache --no-generate pkgnames "$cur" 2> /dev/null ) )
    return 0
}
complete -F _AQ aqg

_AUN()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}

    COMPREPLY=( $( dpkg --get-selections  | grep -v deinstall | awk {' print $1 '} "$cur" 2> /dev/null ) )
    return 0
}
complete -F _AQ aun

_PSQ()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}
    processes=$( ps -A | awk '{print $NF}' | grep -v '\/' | sort | uniq | sed ':a;N;$!ba;s/\n/\ /g' )
    COMPREPLY=( $(compgen -W "$processes" -- "$cur" ) )
    return 0
}
complete -F _PSQ psgrep

_CQ()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}
    local cterm
    cterm="3DES AES AES128 AES256 AESGCM ALL aRSA CAMELLIA CAMELLIA128 CAMELLIA256 CHACHA20 DES EDH EECDH EXPORT FIPS HIGH kEDH kEECDH kRSA LOW MD5 MEDIUM SRP RC2 RC4 RSA SEED SHA SHA1 SHA256 SHA384 SSLv2 SSLv3 TLSv1 TLSv1.2"
    COMPREPLY=( $(compgen -W "$cterm" -- "$cur" ) )
    return 0
}
complete -F _CQ cq

_CQN()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}
    local cterm
    cterm="3DES ADH aDSS AECDH aECDSA AES AES128 AES256 AESGCM ALL aRSA CAMELLIA CAMELLIA128 CAMELLIA256 CHACHA20 COMPLEMENTOFALL DES DH DSS ECDH ECDSA EDH EECDH EXPORT FIPS HIGH kEDH kEECDH kRSA LOW MD5 MEDIUM NULL PSK SRP RC2 RC4 RSA SEED SHA SHA1 SHA256 SHA384 SSLv2 SSLv3 TLSv1 TLSv1.2"
    COMPREPLY=( $(compgen -W "$cterm" -- "$cur" ) )
    return 0
}
complete -F _CQN cqn

_VAGRANT()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}
    local cterm
	cterm="box connect destroy docker-logs docker-run global-status halt help init list-commands login package plugin provision push rdp reload resume rsync rsync-auto share ssh ssh-config status suspend up version"
    COMPREPLY=( $(compgen -W "$cterm" -- "$cur" ) )
    return 0
}
complete -F _VAGRANT vagrant


_BITBUCKET()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}
    local cterm
	cterm="create update delete clone create_from_local pull_request pull download list privilege group-privilege add_remote"
    COMPREPLY=( $(compgen -W "$cterm" -- "$cur" ) )
    return 0
}
complete -F _BITBUCKET bitbucket
complete -F _BITBUCKET bb

_GRM()
{
    local cur
    cur=${COMP_WORDS[COMP_CWORD]}
    local cterm
	cterm=$(git branch --no-color 2> /dev/null | sed 's/*/ /g' 2> /dev/null )
    COMPREPLY=( $(compgen -W "$cterm" -- "$cur" ) )
    return 0
}
complete -F _GRM grm

_COMPOSER()
{
    local foo="${@}"
    local cur prev opts base packages package_names package_repos cmd actions cache_repo_dir cache_file last_argument
    COMPREPLY=()
    cur="${COMP_WORDS[COMP_CWORD]}"
    prev="${COMP_WORDS[COMP_CWORD-1]}"
    cmd=${COMP_WORDS[0]}
    actions=$( $cmd list --raw | cut -f 1 -d " " | tr "\n" " " )
    cache_repo_dir=$($cmd --no-ansi config -g cache-repo-dir)
    cache_file=$cache_repo_dir/https---packagist.org/p-provider-latest.json
    opts=$( $cmd --raw $cur 2>/dev/null  | awk {' print $1 '} 2>/dev/null | grep "\-\-" | tr "\n" " " )
    packages=''
    if [ -f $cache_file ]; then
        packages=$(sed 's/,/\n/g' $cache_file | sed 's/"//g' | sed 's/\:/\t/g' | awk {' print $1 '}  2> /dev/null )
        echo $packages > ~/packages.txt
    fi

    if [[ ${cur} == -* ]] ; then
        if ($cmd > /dev/null 2>&1); then
            case "${prev}" in
                composer)
                    ;;
                composer.phar)
                    ;;
                *)
                    opts=$( $cmd --raw help $prev 2>/dev/null  | awk {' print $1 '} 2>/dev/null | grep "\-\-" | tr "\n" " " )
            esac
        fi
        COMPREPLY=( $(compgen -W "${opts}" -- ${cur}) )
        return 0
    fi

    if ($cmd > /dev/null 2>&1); then
        case "${prev}" in
            require)
                COMPREPLY=( $(compgen -W "$packages" -- "$cur" ) )
                return 0
                ;;
            install)
                COMPREPLY=( $(compgen -W "$packages" -- "$cur" ) )
                return 0
                ;;
            info)
                COMPREPLY=( $(compgen -W "$packages" -- "$cur" ) )
                return 0
                ;;
            depends)
                COMPREPLY=( $(compgen -W "$packages" -- "$cur" ) )
                return 0
                ;;
            search)
                COMPREPLY=( $( $cmd --no-ansi search "$cur" 2> /dev/null | sed 's/\// /g' 2> /dev/null | awk {' print $2 '} 2> /dev/null ) )
                return 0
                ;;
            show)
                COMPREPLY=( $(compgen -W "$packages" -- "$cur" ) )
                return 0
                ;;
            *)
                ;;
        esac
    fi

    if [[ ${cur} == -* ]] ; then
        COMPREPLY=( $(compgen -W "${opts}" -- ${cur}) )
        return 0
    fi

    COMPREPLY=( $(compgen -W "$actions" -- $cur) )
}
complete -F _COMPOSER composer

_ADB()
{
    local foo="${@}"
    local cur prev opts base cmd actions
    cur="${COMP_WORDS[COMP_CWORD]}"
    prev="${COMP_WORDS[COMP_CWORD-1]}"
    cmd=${COMP_WORDS[0]}
    actions=$(adb 2>&1 | grep "  adb " | awk {' print $2 '} | sort | uniq)
    if [[ $COMP_CWORD == 1 ]] ; then
       COMPREPLY=( $(compgen -W "$actions" -- $cur) )
       return 0
    fi
    return 0
}
complete -F _ADB adb

_RMHOST()
{
    local cur
    local hosts
    cur=${COMP_WORDS[COMP_CWORD]}
    #hosts="$(grep -v '#' $HOME/.ssh/known_hosts | awk {' print $1 '})"
    #COMPREPLY=( $( awk {' print $1 '} $HOME/.ssh/known_hosts | grep -v "$cur" | grep -v '#' 2> /dev/null ) )
    hosts=$( awk {' print $1 '} $HOME/.ssh/known_hosts | grep -v '#' | tr '\n' ' ' 2> /dev/null )
    COMPREPLY=( $(compgen -W "$hosts" -- "$cur" ) )
    return 0
}
complete -F _RMHOST RmHost
